Roger Federer beat Rafael Nadal and the south-easter to win the Match in Africa in Cape Town on Friday night. But it was Rugby World Cup-winning Springbok captain Siya Kolisi who received the loudest cheer of the night when he emerged to toss the coin at Cape Town Stadium. And it was comedian Trevor Noah that had the crowd on its feet at the end by saying: "It's events like these that remind South Africans of what we can do in the world." Then the dancing started, and Twitter videos showed the players and even Federer's 67-year-old South African mother, Lynette, joining in. The match raised $3.5m (R52.5m) for Federer's foundation, and the crowd of 51,954 set a new world record for a tennis match. They rose to their feet as Kolisi, wearing a leg brace after suffering a knee injury playing for the Stormers last weekend, emerged from the tunnel. The Bok captain was given the Swiss 20-franc coin bearing Federer's image after tossing it, and handed Federer a Springbok jersey which he wore during his warm-up. Federer went on to beat Nadal 6-4, 3-6, 6-3, and the Spaniard said it had been a "lifetime experience". He added: "It was a big pleasure for me to be part of it. Thanks everybody for supporting and for making this day very, very special." Federer said he and Nadal had played "the best tennis we can", but the "magical evening" had been about much more than tennis. When play started in gusty conditions, Federer broke Nadal's serve after the first game went to deuce, then held his serve to take a 2-0 lead. But Nadal held serve in the third game, making the score 2-1. Federer dominated Nadal to make the score 3-1, showing no signs that he was feeling the groin strain he sustained during the Australian Open in Melbourne. Both players held serve to take the score to 4-2. Then Nadal rushed to the net and volleyed past Federer to take the score to 4-3. A remarkable rally handed the host the next game to put him within touching distance of the set. Nadal held serve to take the score to 5-4, leaving Federer to hold serve for the first set. A vintage wide serve and volley gave Federer three set points, and he won with an ace. A Federer double fault in which both serves bounced out off the net cord gave Nadal two break points in the second game of the second set, and the Spaniard converted for a 2-0 lead. With the help of a mistimed return of service which left Nadal scrambling, Federer broke back to 2-1. But Nadal immediately broke back to leave him with a 3-1 advantage, which he extended to 4-1 by holding his own serve. The players handed their racquets to a ballboy and ballgirl, allowing them to play a couple of points before resuming their rivalry. Federer then saved two break points to haul the deficit back to 4-2 in the best-of-three-sets match, but he faced an uphill struggle to save the set when Nadal made it 5-2. He saved a set point and delivered two successive aces to make it 5-3 but Nadal was on a roll on his own service and took the final game to level the match at 1-1. Federer broke Nadal's serve in the second game of the final set, then held his own with another two aces to give him a 3-0 lead. Nadal hauled the deficit back to 3-1, and there was no sign that the players were flagging or giving anything less than their all as Federer executed a magnificent backhand smash at the net to give himself game point. Soon the score was 4-1, and Federer was within two games of maintaining his 100% victory record in the five Matches for Africa he has hosted since the first - also against Nadal - in Zurich in 2010. New balls were produced with the score on 4-2 and Federer used them to race to a 5-2 lead. Nadal made it 5-3 and Federer served for the match, winning with a delicate drop volley at the net. Earlier, a monstrous 52-shot fifth point that included a grunt fest involving the world No 2 and No 3 players was the highlight of the doubles match between Federer and Bill Gates and Nadal and Noah. But it was two double faults by Noah in the eight game that handed Federer and Gates - dubbed Gateserer on social media - the first break of serve, taking the score to 5-3. Within seconds it was 6-3, condemning the wisecracking Noah and Nadal to defeat. Noah blamed the wind when he hit a service return long at deuce in the third game, but the sudden-death system being used for the match meant Federer and Gates went 2-1 up. Then the host of The Daily Show in the US came back from a double fault to hold his serve and take the score to 2-2. Along the way he poked fun at Nadal's baseline routine as he prepares to serve, to the amusement of the crowd and his fellow players. "Ah no. Now we start," muttered Nadal. The song African Dream launched the world record-breaking event. The Ndlovu Youth Choir, who won global acclaim with their appearances on America's Got Talent last year, performed the song as children from Cape Town's Zip Zap Circus swung on trapezes. "I'm feeling incredibly excited," Federer told MC Rob Koenig before the doubles match, and Gates said he was a "little bit" nervous but thrilled to play in his third Match for Africa. Federer said the welcome he had received since arriving in Cape Town on Wednesday had been "worth the wait" after a lengthy absence from the country of his mother's birth. Nadal and Noah emerged to huge cheers from the crowd, and the comedian said he was "in Federer's head". Nadal said it was simple to beat Federer as long as you were aggressive and played incredibly well. Then MC Carol Tshabalala welcomed Johannesburg-born Lynette Federer to the court. She tossed the coin before launching into an interview with Koenig in fluent Afrikaans. "We love the people, we love the country, we just love you all," she said. Sporting celebrities in the crowd included Rugby World Cup-winning Springbok captain John Smit, former Boks Jean de Villiers and Bryan Habana and swimmer Ryk Neethling. Former DA leader Mmusi Maimane and businessman Patrice Motsepe were also there. The stadium gates opened at 4.30pm, shortly after the world No 3 (Federer) and Nadal finished a practice session on the orange hard-court built over the pitch. Traffic began to build up in the city centre soon after the first roads around the stadium were closed at noon. Federer started his day in the Bo-Kaap before a photo session with Nadal and the players' families on the Grand Parade in central Cape Town. Then the two stars spent time with children from Hangberg Pre-Primary School in Hout Bay at a “learning through play” session at Green Point Athletics Stadium. The Match in Africa benefits Federer's foundation, which in the last 16 years has spent almost R800m on education projects in SA, five other Southern African countries and Switzerland.